(function(){"use strict";var e={37024:function(e,t,a){var i=a(36369),n=function(){var e=this,t=e._self._c;return t("div",{attrs:{id:"app"}},["/"!==this.$route.path?t("nav",{staticClass:"nav"},[t("router-link",{attrs:{to:"/projects"}},[e._v("Projects")]),e._v(" | "),t("router-link",{attrs:{to:"/simulation"}},[e._v("Simulation")]),e._v(" | "),t("router-link",{attrs:{to:"/join-tables"}},[e._v("Join Tables")]),e._v(" | "),t("router-link",{attrs:{to:"/sermon-calendar"}},[e._v("Sermon Calendar")])],1):e._e(),t("router-view")],1)},l=[],s={},r=s,o=a(1001),c=(0,o.Z)(r,n,l,!1,null,null,null),u=c.exports,d=a(8499),h=a.n(d);i["default"].use(h());var m=a(72631),p=function(){var e=this,t=e._self._c;return t("div",{staticClass:"home"},[e._v("_The LORD is my shepherd. 🐑")])},f=[],b={name:"HomeView"},v=b,g=(0,o.Z)(v,p,f,!1,null,null,null),y=g.exports,C=function(){var e=this,t=e._self._c;return t("div",{staticClass:"my-projects"},[e._v("Projects")])},_=[],w={name:"my-projects",data(){return{}}},x=w,k=(0,o.Z)(x,C,_,!1,null,"61bccf3e",null),L=k.exports,T=function(){var e=this,t=e._self._c;return t("div",{staticClass:"join-tables"},[t("el-container",[t("el-aside",{attrs:{width:"240px"}},[t("j-source",{attrs:{name:"数据库",data:e.databaseTreeData}}),t("j-source",{attrs:{name:"数据集",data:e.datasetTreeData}})],1),t("el-container",[t("el-header",[t("j-header",{on:{changeView:e.changeView}})],1),t("el-main",{staticClass:"main"},[t("j-builder",{directives:[{name:"show",rawName:"v-show",value:"Builder"===e.view,expression:"view === 'Builder'"}]}),t("j-sql",{directives:[{name:"show",rawName:"v-show",value:"SQL"===e.view,expression:"view === 'SQL'"}]}),t("j-data",{directives:[{name:"show",rawName:"v-show",value:"Data"===e.view,expression:"view === 'Data'"}],attrs:{data:e.tableData}})],1)],1)],1)],1)},S=[],F=function(){var e=this,t=e._self._c;return t("el-card",{staticStyle:{margin:"15px"},attrs:{shadow:"never"}},[t("span",{attrs:{slot:"header"},slot:"header"},[e._v(e._s(e.name))]),t("draggable",{staticClass:"list",attrs:{tag:"div",group:{name:"dragobj",pull:"clone",put:!1},clone:e.cloneData},on:{start:function(t){e.drag=!0},end:function(t){e.drag=!1}},model:{value:e.dataList,callback:function(t){e.dataList=t},expression:"dataList"}},e._l(e.dataList,(function(a){return t("div",{key:a.id,staticClass:"item",class:{active:a.show},attrs:{title:a.title}},[t("span",{staticClass:"arrow",on:{click:function(e){a.show=!a.show}}},[t("i",{staticClass:"el-icon-arrow-right"})]),t("div",{staticClass:"head"},[t("i",{staticClass:"el-icon-folder"}),e._v(" "+e._s(a.title))]),t("el-collapse-transition",[t("ul",{directives:[{name:"show",rawName:"v-show",value:a.show,expression:"item.show"}],staticClass:"sublist"},e._l(a.fields,(function(a,i){return t("li",{key:i},[t("i",{staticClass:"el-icon-document"}),e._v(" "+e._s(a.label)+" ")])})),0)])],1)})),0)],1)},D=[],P=a(76983),O=a.n(P),I=a(40536),V={name:"JSource",components:{draggable:O()},props:{name:{type:String,default:""},data:{type:Array,default:()=>[]}},data(){return{filter:"",dataList:[]}},methods:{cloneData(e){const t=JSON.parse(JSON.stringify(e));return t.id=(0,I.Z)(),t}},mounted(){this.dataList=this.data}},E=V,$=(0,o.Z)(E,F,D,!1,null,null,null),Y=$.exports,j=function(){var e=this,t=e._self._c;return t("el-form",{staticClass:"mt-3",attrs:{inline:!0,model:e.dataSetForm,size:"small"}},[t("el-radio-group",{attrs:{size:"small"},on:{change:e.changeView},model:{value:e.view,callback:function(t){e.view=t},expression:"view"}},e._l(e.viewList,(function(e){return t("el-radio-button",{key:e.label,attrs:{label:e.label}})})),1),[t("el-form-item",{attrs:{label:"数据集名称"}},[t("el-input",{model:{value:e.dataSetForm.user,callback:function(t){e.$set(e.dataSetForm,"user",t)},expression:"dataSetForm.user"}})],1),t("el-form-item",{attrs:{label:"",prop:"allowReuse"}},[t("el-checkbox",{model:{value:e.dataSetForm.allowReuse,callback:function(t){e.$set(e.dataSetForm,"allowReuse",t)},expression:"dataSetForm.allowReuse"}},[e._v("允许复用")])],1),t("el-form-item",[t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.saveDataSet()}}},[e._v("保存")])],1)]],2)},M=[],z={name:"JHeader",data(){return{dataSetForm:{name:"",allowReuse:!1},view:"Builder",viewList:[{label:"Builder",value:"1"},{label:"SQL",value:"2"},{label:"Data",value:"3"}]}},methods:{changeView(e){this.$emit("changeView",e)},saveDataSet(){}}},G=z,Z=(0,o.Z)(G,j,M,!1,null,null,null),N=Z.exports,A=function(){var e=this,t=e._self._c;return t("el-container",{staticClass:"j-builder"},[t("el-main",{staticClass:"position-relative p-0"},[t("el-container",{staticClass:"h-100"},[e._l(e.unionList,(function(a,i){return t("el-main",{directives:[{name:"show",rawName:"v-show",value:e.currentIndex===i,expression:"currentIndex === index"}],key:i},[t("transition-group",{staticClass:"table-wrap",attrs:{name:"el-zoom-in-center",tag:"div"}},e._l(a.lineList,(function(a){return t("div",{key:a.id,staticClass:"line",style:{"--before-height":a.style.leftHeight+"px","--after-height":a.style.rightHeight+"px",left:a.style.left+"px",top:a.style.top+"px",width:a.style.width+"px"}},[t("el-dropdown",{attrs:{placement:"bottom-start","show-timeout":300,"hide-timeout":200},on:{command:function(t){return e.lineSetting(t,a)}}},[t("i",{staticClass:"el-icon-connection",class:{active:e.activeId===a.id},on:{click:function(t){return e.joinLine("line",a.id)}}}),t("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[t("el-dropdown-item",{attrs:{icon:"el-icon-edit-outline",command:"setting"}},[e._v("设置")]),t("el-dropdown-item",{attrs:{icon:"el-icon-delete",command:"delete"}},[e._v("删除")])],1)],1)],1)})),0),t("draggable",{staticClass:"draggable",attrs:{tag:"div",group:"dragobj",handle:".el-card__header"},on:{start:function(t){e.drag=!0},end:function(t){e.drag=!1},change:e.changeList},model:{value:a.tableList,callback:function(t){e.$set(a,"tableList",t)},expression:"union.tableList"}},[t("transition-group",{staticClass:"table-wrap",attrs:{name:"el-zoom-in-center",tag:"div"}},e._l(a.tableList,(function(a){return t("div",{key:a.id,ref:a.id,refInFor:!0,staticClass:"table"},[t("div",{staticClass:"dot",class:{active:e.activeId===a.id},on:{click:function(t){return e.joinLine("table",a.id)}}}),t("el-card",{attrs:{shadow:"never"}},[t("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[t("div",{staticStyle:{"line-height":"130%"}},[e._v(" "+e._s(a.title)),t("br"),t("small",{staticStyle:{color:"#999"}},[e._v(e._s(a.code))])]),t("el-popover",{attrs:{width:"160"},model:{value:a.showConfirm,callback:function(t){e.$set(a,"showConfirm",t)},expression:"table.showConfirm"}},[t("p",[e._v("确定删除该子数据集吗？")]),t("div",{staticStyle:{"text-align":"right",margin:"0"}},[t("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(e){a.showConfirm=!1}}},[e._v("取消")]),t("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){return e.deleteTable(a)}}},[e._v("确定")])],1),t("el-button",{staticStyle:{position:"absolute",right:"-8px",top:"-8px"},attrs:{slot:"reference",type:"default",plain:"",size:"mini",icon:"el-icon-close",circle:""},slot:"reference"})],1)],1),t("div",[e._v(e._s(a.text))]),t("el-table",{ref:"table",refInFor:!0,attrs:{data:a.fields,size:"small","show-header":!1,"row-class-name":e.tableRowClassName},on:{"row-click":function(t){return e.clickRow(a,t)}}},[t("el-table-column",{attrs:{width:"40",label:"选择"},scopedSlots:e._u([{key:"default",fn:function({row:i}){return[t("el-checkbox",{key:i.value,attrs:{disabled:i.select,"active-color":"#409EFF","inactive-color":"#999"},on:{change:function(t){return e.toList(a,i)}},model:{value:i.select,callback:function(t){e.$set(i,"select",t)},expression:"row.select"}})]}}],null,!0)}),t("el-table-column",{attrs:{prop:"label",label:"字段名"}})],1)],1)],1)})),0)],1),e.unionList[e.currentIndex].tableList.length?e._e():t("el-empty",{attrs:{description:"请将左侧的数据拖入这里"}})],1)})),t("el-footer",{staticClass:"footer",attrs:{height:"120px"}},[e._v("111")])],2)],1),t("el-aside",{attrs:{width:"360px"}},[t("div",{staticClass:"pannel"},[e.fieldForm.label?t("el-form",{attrs:{model:e.fieldForm,size:"mini","label-position":"right"}},[e.unionList[e.currentIndex].fieldList.length?t("el-divider",{staticClass:"mt-5 mb-3",attrs:{"content-position":"left"}},[e._v(e._s(e.fieldForm.tableTitle))]):e._e(),t("el-form-item",{staticClass:"mb-2",attrs:{label:"字段名"}},[t("el-input",{attrs:{disabled:""},model:{value:e.fieldForm.label,callback:function(t){e.$set(e.fieldForm,"label",t)},expression:"fieldForm.label"}})],1),t("el-form-item",{staticClass:"mb-2",attrs:{label:"别名"}},[t("el-input",{model:{value:e.fieldForm.name,callback:function(t){e.$set(e.fieldForm,"name",t)},expression:"fieldForm.name"}})],1),"string"===e.fieldForm.type?t("el-form-item",{staticClass:"mb-2",attrs:{label:"字符串格式"}},[t("el-select",{attrs:{placeholder:"字符串格式"},model:{value:e.fieldForm.stringType,callback:function(t){e.$set(e.fieldForm,"stringType",t)},expression:"fieldForm.stringType"}},[t("el-option",{attrs:{label:"Count",value:"1"}})],1)],1):e._e(),"date"===e.fieldForm.type?t("el-form-item",{staticClass:"mb-2",attrs:{label:"日期格式"}},[t("el-select",{attrs:{placeholder:"日期格式"},model:{value:e.fieldForm.dateType,callback:function(t){e.$set(e.fieldForm,"dateType",t)},expression:"fieldForm.dateType"}},[t("el-option",{attrs:{label:"YYYY",value:"1"}}),t("el-option",{attrs:{label:"MM",value:"2"}}),t("el-option",{attrs:{label:"YYYY-MM-DD",value:"3"}}),t("el-option",{attrs:{label:"YYYY-MM-DD ",value:"4"}}),t("el-option",{attrs:{label:"YYYY-MM-dd HH:mm:ss",value:"5"}})],1)],1):e._e(),"number"===e.fieldForm.type?t("el-form-item",{attrs:{label:"数字聚合"}},[t("el-select",{attrs:{placeholder:"数字聚合"},model:{value:e.fieldForm.numberType,callback:function(t){e.$set(e.fieldForm,"numberType",t)},expression:"fieldForm.numberType"}},[t("el-option",{attrs:{label:"Max",value:"1"}}),t("el-option",{attrs:{label:"Min",value:"2"}}),t("el-option",{attrs:{label:"Avg",value:"3"}}),t("el-option",{attrs:{label:"Sum",value:"4"}}),t("el-option",{attrs:{label:"Count",value:"5"}})],1)],1):e._e(),t("el-form-item",[t("el-button",{attrs:{type:"primary"},on:{click:e.saveFieldForm}},[e._v("保存")])],1)],1):e._e(),e.unionList[e.currentIndex].fieldList.length?t("el-divider",{staticClass:"mt-5 mb-3",attrs:{"content-position":"left"}},[e._v("列表")]):e._e(),t("draggable",{staticClass:"list",attrs:{tag:"div",group:{name:"dragobj",pull:"clone",put:!1}},on:{start:function(t){e.drag=!0},end:function(t){e.drag=!1}},model:{value:e.unionList[e.currentIndex].fieldList,callback:function(t){e.$set(e.unionList[e.currentIndex],"fieldList",t)},expression:"unionList[currentIndex].fieldList"}},e._l(e.unionList[e.currentIndex].fieldList,(function(a,i){return t("div",{key:a.id,staticClass:"item",class:{active:a.show},attrs:{title:a.title}},[t("span",{staticClass:"arrow",on:{click:function(e){a.show=!a.show}}},[t("i",{staticClass:"el-icon-close",on:{click:function(t){return e.toTable(a,i)}}})]),t("div",{staticClass:"head"},[t("i",{staticClass:"el-icon-document"}),t("strong",[e._v(e._s(a.tableTitle))]),e._v(" "+e._s(a.label)+" ")])])})),0)],1),t("div",{staticClass:"j-union"},[t("el-select",{staticStyle:{width:"100%","margin-bottom":"20px"},attrs:{size:"small",placeholder:"Union类型",clearable:""},model:{value:e.unionType,callback:function(t){e.unionType=t},expression:"unionType"}},e._l(e.unionOptions,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1),t("div",{staticClass:"union-list"},[e._l(e.unionList,(function(a,i){return t("div",{key:i,staticClass:"item",class:{active:i===e.currentIndex},on:{click:function(t){return e.changeSubDataSet(i)}}},[e.unionList&&e.unionList.length>1?t("el-popover",{attrs:{placement:"left",width:"160"},model:{value:a.showConfirm,callback:function(t){e.$set(a,"showConfirm",t)},expression:"item.showConfirm"}},[t("p",[e._v("确定删除该子数据集吗？")]),t("div",{staticStyle:{"text-align":"right",margin:"0"}},[t("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(e){a.showConfirm=!1}}},[e._v("取消")]),t("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){return e.deleteSubDataSet(i)}}},[e._v("确定")])],1),t("el-button",{attrs:{slot:"reference",type:"default",plain:"",size:"mini",icon:"el-icon-close",circle:""},slot:"reference"})],1):e._e(),t("span",[e._v("子数据集 #"+e._s(i+1))])],1)})),t("i",{staticClass:"el-icon-connection"})],2),t("div",{staticClass:"item btn",on:{click:function(t){return e.addSubDataSet()}}},[t("i",{staticClass:"el-icon-plus"})])],1)]),t("j-setting",{ref:"setting",attrs:{"start-options":e.startOptions,"end-options":e.endOptions},on:{save:e.saveSetting}})],1)},J=[],R=function(){var e=this,t=e._self._c;return t("el-dialog",{attrs:{title:"关联设置",visible:e.settingDialog,width:"400px","before-close":e.closeSetting,"close-on-click-modal":!1},on:{"update:visible":function(t){e.settingDialog=t}}},[t("el-form",{attrs:{model:e.form,size:"medium","label-position":"top"}},[t("el-form-item",{attrs:{label:"关联类型"}},[t("el-select",{staticClass:"w-100",attrs:{clearable:""},model:{value:e.form.type,callback:function(t){e.$set(e.form,"type",t)},expression:"form.type"}},e._l(e.joinOptions,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),t("el-form-item",{attrs:{label:"数据源1"}},[t("el-select",{staticClass:"w-100",attrs:{filterable:"",clearable:""},model:{value:e.form.table1,callback:function(t){e.$set(e.form,"table1",t)},expression:"form.table1"}},e._l(e.startOptions,(function(a,i){return t("el-option-group",{key:i,attrs:{label:a.label}},e._l(a.fields,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)})),1)],1),t("el-form-item",{attrs:{label:"比较"}},[t("el-select",{staticClass:"w-100",attrs:{clearable:""},model:{value:e.form.compare,callback:function(t){e.$set(e.form,"compare",t)},expression:"form.compare"}},e._l(e.compareOptions,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),t("el-form-item",{attrs:{label:"数据源2"}},[t("el-select",{staticClass:"w-100",attrs:{filterable:"",clearable:""},model:{value:e.form.table2,callback:function(t){e.$set(e.form,"table2",t)},expression:"form.table2"}},e._l(e.endOptions,(function(a,i){return t("el-option-group",{key:i,attrs:{label:a.label}},e._l(a.fields,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)})),1)],1)],1),t("span",{attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{size:"medium"},on:{click:e.closeSetting}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary",size:"medium"},on:{click:e.saveSetting}},[e._v("保 存")])],1)],1)},H=[];const B={type:"",table1:[],compare:"",table2:[]};var W={name:"JSetting",props:{startOptions:{type:Array,default:()=>[]},endOptions:{type:Array,default:()=>[]}},data(){return{settingDialog:!1,lineId:"",form:{...B},joinOptions:[{label:"左关联",value:"1"},{label:"右关联",value:"2"},{label:"内关联",value:"3"},{label:"全关联",value:"4"},{label:"笛卡尔积",value:"5"}],compareOptions:[{label:"大于",value:"1"},{label:"小于",value:"2"},{label:"等于",value:"3"}]}},methods:{init(e,t){this.lineId=e,t&&Object.keys(t).length&&(this.form=t),this.settingDialog=!0},closeSetting(){this.form={...B},this.settingDialog=!1},saveSetting(){this.$emit("save",this.lineId,this.form),this.closeSetting()}}},U=W,q=(0,o.Z)(U,R,H,!1,null,null,null),Q=q.exports;const X={type:"",id:""};var K={name:"JBuilder",components:{draggable:O(),JSetting:Q},data(){return{activeId:"",addLine:{id:"",startPoint:{...X},endPoint:{...X}},activeRow:{},fieldForm:{},startOptions:[],endOptions:[],unionList:[{index:0,tableList:[],lineList:[],fieldList:[]}],unionType:"",currentIndex:0,unionOptions:[{label:"UNION",value:"1"},{label:"UNION ALL",value:"2"}]}},methods:{resetData(){this.addLine={id:"",startPoint:{...X},endPoint:{...X}},this.activeId=""},async createLine(){this.unionList[this.currentIndex].lineList.length&&(this.unionList[this.currentIndex].lineList.forEach((e=>{const t=this.genarateLine(e.startPoint,e.endPoint);this.$set(e,"style",t)})),this.resetData())},genarateLine(e,t){let a=0,i=0,n=0,l=0,s=0;const r=16;return"table"===e.type?this.unionList[this.currentIndex].tableList.forEach((t=>{if(t.id===e.id){const e=this.$refs[t.id][0];i=e.offsetLeft+e.clientWidth/2,(!a||a>=e.offsetTop)&&(a=e.offsetTop-r-4),n<e.offsetTop&&(n=e.offsetTop)}})):"line"===e.type&&this.unionList[this.currentIndex].lineList.forEach((t=>{if(t.id===e.id){const e=t.style;i=e.left+e.width/2,(!a||a>=e.top)&&(a=e.top-r),n<e.top&&(n=e.top)}})),"table"===t.type?this.unionList[this.currentIndex].tableList.forEach((e=>{if(e.id===t.id){const t=this.$refs[e.id][0];l=t.offsetLeft+t.clientWidth/2,(!a||a>=t.offsetTop)&&(a=t.offsetTop-r-4),s<t.offsetTop&&(s=t.offsetTop)}})):"line"===t.type&&this.unionList[this.currentIndex].lineList.forEach((e=>{if(e.id===t.id){const t=e.style;l=t.left+t.width/2,(!a||a>=t.top)&&(a=t.top-r),s<t.top&&(s=t.top)}})),i<l?{left:i,top:a,width:l-i,leftHeight:n-a,rightHeight:s-a}:{left:l,top:a,width:i-l,leftHeight:s-a,rightHeight:n-a}},joinLine(e,t){if("table"===e){let e=this.unionList[this.currentIndex].lineList.find((e=>e.startPoint.id===t||e.endPoint.id===t));if(e)return;if(this.activeId===t)return void this.resetData();this.activeId=t}else{let e=this.unionList[this.currentIndex].lineList.find((e=>e.startPoint.id===t||e.endPoint.id===t));if(e)return void console.log("该点不允许");if(this.activeId===t)return void this.resetData();this.activeId=t}if(this.addLine.startPoint.id){if(this.addLine.startPoint.id===t)return void(this.addLine.startPoint={...X});this.addLine.endPoint.id=t,this.addLine.endPoint.type=e,this.addLine.id=(0,I.Z)(),this.unionList[this.currentIndex].lineList.push(this.addLine),this.createLine()}else this.addLine.startPoint.id=t,this.addLine.startPoint.type=e},getOptions(e){let t=[];const a=e=>{if("table"===e.type){const a=this.unionList[this.currentIndex].tableList.find((t=>t.id===e.id));let i=a.fields.filter((e=>!e.select));t.push({label:a.title,fields:i})}else this.unionList[this.currentIndex].lineList.forEach((t=>{t.id===e.id&&(a(t.startPoint),a(t.endPoint))}))};return a(e),t},lineSetting(e,t){"setting"===e?(this.startOptions=this.getOptions(t.startPoint,!1),this.endOptions=this.getOptions(t.endPoint,!1),this.$refs.setting.init(t.id,t.setting)):"delete"===e&&(this.deleteLine(t.id),this.resetData())},saveSetting(e,t){this.unionList[this.currentIndex].lineList.forEach((a=>{a.id===e&&(a.setting=t)}))},deleteLine(e){const t=this.unionList[this.currentIndex].lineList.findIndex((t=>t.id===e));this.unionList[this.currentIndex].lineList.splice(t,1),this.createLine(),this.unionList[this.currentIndex].lineList.forEach((t=>{t.startPoint.id!==e&&t.endPoint.id!==e||this.deleteLine(t.id)}))},deleteTable(e){e.showConfirm=!1;const t=this.unionList[this.currentIndex].tableList.findIndex((t=>t.id===e.id));this.unionList[this.currentIndex].tableList.splice(t,1),this.unionList[this.currentIndex].lineList.forEach((t=>{("table"===t.startPoint.type&&t.startPoint.id===e.id||"table"===t.endPoint.type&&t.endPoint.id===e.id)&&this.deleteLine(t.id)}))},changeList(){this.$nextTick((()=>{this.createLine()}))},toList(e,t){const a=Object.assign({tableTitle:e.title,tableId:e.id},t);this.unionList[this.currentIndex].fieldList.push(a)},toTable(e,t){this.unionList[this.currentIndex].tableList.forEach((t=>{t.fields.forEach((t=>{t.id===e.id&&(t.select=!1)}))})),this.unionList[this.currentIndex].fieldList.splice(t,1)},clickRow(e,t){this.activeRow!==t?(this.activeRow=t,this.fieldForm=Object.assign({tableTitle:e.title,tableId:e.id},t)):(this.activeRow={},this.fieldForm={})},tableRowClassName({row:e}){return e===this.activeRow?"active-row":""},saveFieldForm(){this.unionList[this.currentIndex].tableList.forEach((e=>{e.id===this.fieldForm.tableId&&e.fields.forEach((e=>{e.id===this.fieldForm.id&&(e.name=this.fieldForm.name,this.fieldForm.stringType?e.stringType=this.fieldForm.stringType:this.fieldForm.dateType?e.dateType=this.fieldForm.dateType:this.fieldForm.numberType&&(e.numberType=this.fieldForm.numberType))}))}))},addSubDataSet(){const e=this.unionList.length;this.unionList.push({index:e,tableList:[],lineList:[],fieldList:[]})},deleteSubDataSet(e){this.unionList.splice(e,1)},changeSubDataSet(e){this.fieldForm={tableTitle:"",label:"",name:"",dimension:"",fieldType:""},this.activeId="",this.activeRow={},this.currentIndex=e}}},ee=K,te=(0,o.Z)(ee,A,J,!1,null,null,null),ae=te.exports,ie=function(){var e=this,t=e._self._c;return t("div",{staticClass:"j-sql"},[t("el-input",{attrs:{type:"textarea",rows:"7"},model:{value:e.text,callback:function(t){e.text=t},expression:"text"}})],1)},ne=[],le={name:"JSql",data(){return{text:"SELECT *FROM my_contacts;SELECT *FROM my_contacts;SELECT *FROM my_contacts;SELECT *FROM my_contacts;"}},methods:{}},se=le,re=(0,o.Z)(se,ie,ne,!1,null,null,null),oe=re.exports,ce=function(){var e=this,t=e._self._c;return t("div",{staticClass:"j-data"},[t("el-table",{attrs:{data:e.data,size:"medium"}},[t("el-table-column",{attrs:{prop:"date",label:"日期","render-header":e.renderHeader}}),t("el-table-column",{attrs:{prop:"name",label:"姓名","render-header":e.renderHeader}}),t("el-table-column",{attrs:{prop:"address",label:"地址","render-header":e.renderHeader}}),t("el-table-column",{attrs:{prop:"text9",label:"字段9","render-header":e.renderHeader}})],1)],1)},ue=[],de={name:"JData",props:{data:{type:Array,default:()=>[]}},data(){return{fieldForm:{name:"test",editableName:!1,dimension:"",fieldType:""},dimensionOptions:[{label:"维度",value:"1"},{label:"统计值",value:"2"}],fieldTypeOptions:[{label:"字符串",value:"1"},{label:"数字",value:"2"},{label:"日期",value:"3"}]}},methods:{renderHeader(e,{column:t}){return e("div",{},[e("span",{style:{marginRight:"10px"}},t.label),e("el-popover",{props:{placement:"bottom-start",width:"240",trigger:"click"}},[e("el-form",{props:{model:this.fieldForm,labelPosition:"right",labelWidth:"80px",size:"small"}},[e("el-form-item",{props:{label:"名称"}},[e("el-input",{props:{disabled:!this.fieldForm.editableName,value:this.fieldForm.name,clearable:!0},style:{width:"80%"},on:{input:e=>{this.fieldForm.name=e}}}),e("i",{class:"el-icon-edit-outline",style:{cursor:"pointer",marginLeft:"6px"},props:{},on:{click:()=>{this.fieldForm.editableName=!0}}})]),e("el-form-item",{props:{label:"维度"}},[e("el-select",{props:{value:this.fieldForm.dimension},style:{width:"90%"},on:{input:e=>{this.fieldForm.dimension=e}}},[this.dimensionOptions.map((t=>e("el-option",{props:{value:t.value,label:t.label}})))])]),e("el-form-item",{props:{label:"字段类型"}},[e("el-select",{props:{value:this.fieldForm.fieldType},style:{width:"90%"},on:{input:e=>{this.fieldForm.fieldType=e}}},[this.fieldTypeOptions.map((t=>e("el-option",{props:{value:t.value,label:t.label}})))])]),e("el-form-item",{},[e("el-button",{props:{type:"primary"},domProps:{innerText:"保 存"}}),e("el-button",{domProps:{innerText:"取 消"}})])]),e("i",{slot:"reference",class:"el-icon-arrow-down",style:{cursor:"pointer"},props:{}})])])}}},he=de,me=(0,o.Z)(he,ce,ue,!1,null,null,null),pe=me.exports,fe={name:"JoinTables",components:{JSource:Y,JHeader:N,JBuilder:ae,JSql:oe,JData:pe},data(){return{databaseTreeData:[{title:"第1个表",tableId:"table01",code:"TABLE_01",show:!1,fields:[{id:101,label:"表1-日期字段1",value:"101",type:"date"},{id:102,label:"表1-字符串字段2",value:"102",type:"string"},{id:103,label:"表1-数字字段3",value:"103",type:"number"}]},{title:"第2个表",tableId:"table02",code:"TABLE_02",show:!1,fields:[{id:201,label:"表2-字段1",value:"201",type:"number"},{id:202,label:"表2-字段2",value:"202",type:"number"}]},{title:"第3个表",tableId:"table03",code:"TABLE_03",show:!1,fields:[{id:301,label:"表3-字段1",value:"301",type:"string"},{id:302,label:"表3-字段2",value:"302",type:"date"}]}],datasetTreeData:[{title:"第1个表",tableId:"table11",code:"TABLE_11",show:!1,fields:[{id:401,label:"表1-字段1",value:"401",type:"string"},{id:402,label:"表1-字段2",value:"402",type:"date"},{id:403,label:"表1-字段3",value:"403",type:"string"}]},{title:"第2个表",tableId:"table12",code:"TABLE_12",show:!1,fields:[{id:501,label:"表2-字段1",value:"501",type:"date"},{id:502,label:"表2-字段2",value:"502",type:"number"}]}],view:"Builder",tableData:[{date:"2016-05-02",name:"王小虎",address:"上海市普陀区金沙江路 1518 弄",text9:"199"},{date:"2016-05-04",name:"王小虎",address:"上海市普陀区金沙江路 1517 弄",text9:"299"},{date:"2016-05-01",name:"王小虎",address:"上海市普陀区金沙江路 1519 弄",text9:"399"},{date:"2016-05-03",name:"王小虎",address:"上海市普陀区金沙江路 1516 弄",text9:"499"}]}},methods:{changeView(e){this.view=e}}},be=fe,ve=(0,o.Z)(be,T,S,!1,null,null,null),ge=ve.exports,ye=function(){var e=this,t=e._self._c;return t("div",{staticClass:"simulation"},[t("el-row",{staticClass:"mb-3",attrs:{gutter:16}},[t("el-col",{attrs:{span:18}},[t("el-card",[t("ul",{staticClass:"total-charts"},e._l(e.totalList,(function(a,i){return t("li",{key:i},[t("div",{staticClass:"total-charts__chart"},[t("chart",{ref:"chart",refInFor:!0,staticStyle:{width:"170px",height:"170px"},attrs:{options:a.chartOption,autoresize:""}}),a.benchmark?t("count-to",{staticClass:"chart-percent",attrs:{startVal:0,endVal:e.getChartPercentage(a.benchmark,a.planning),duration:1e3,decimals:0,suffix:"%"}}):t("span",{staticClass:"chart-percent"},[e._v("N/A")])],1),t("div",{staticClass:"total-charts__text"},[t("h5",{staticClass:"text-darker-grey"},[e._v(" "+e._s(a.name)+" "),t("small",[e._v("("+e._s(a.unit)+")")])]),t("p",[t("span",{staticClass:"text-grey"},[e._v(e._s(e.searchForm.benchmarkYear)+": "),t("count-to",{staticClass:"value",attrs:{startVal:0,endVal:a.benchmark,duration:1e3,decimals:0}})],1),t("br"),e._v(" "+e._s(e.searchForm.planningYear)+": "),t("count-to",{staticClass:"value",attrs:{startVal:0,endVal:a.planning,duration:1e3,decimals:0}})],1)])])})),0)])],1),t("el-col",{attrs:{span:6}},[t("el-card",{staticStyle:{height:"212px"}},[t("el-form",{ref:"form",attrs:{model:e.searchForm,"label-width":"120px"}},[t("el-form-item",{staticClass:"mb-3",attrs:{label:"benchmarkYear",prop:"benchmarkYear"}},[t("el-date-picker",{staticClass:"w-100",attrs:{type:"year",placeholder:"selectYear",clearable:!1},model:{value:e.searchForm.benchmarkYear,callback:function(t){e.$set(e.searchForm,"benchmarkYear",t)},expression:"searchForm.benchmarkYear"}})],1),t("el-form-item",{staticClass:"mb-3",attrs:{label:"planningYear",prop:"planningYear"}},[t("el-date-picker",{staticClass:"w-100",attrs:{type:"year",placeholder:"selectYear",clearable:!1},model:{value:e.searchForm.planningYear,callback:function(t){e.$set(e.searchForm,"planningYear",t)},expression:"searchForm.planningYear"}})],1),t("el-form-item",{staticClass:"mb-3",attrs:{label:"organisation",prop:"organisation"}}),t("el-form-item",[t("el-button",{attrs:{type:"primary"}},[e._v("search")])],1)],1)],1)],1)],1),t("el-card",[t("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[t("span",[e._v("Portfolio Simulation")]),t("div",{staticClass:"float-right"},[t("el-select",{staticStyle:{width:"170px"},attrs:{size:"mini",placeholder:"Choose Other Energy"},on:{change:e.addEnergy},model:{value:e.selectEnergy,callback:function(t){e.selectEnergy=t},expression:"selectEnergy"}},e._l(e.energyList,(function(e){return t("el-option",{key:e.id,attrs:{label:e.name,value:e.id,disabled:e.show}})})),1)],1)]),t("transition-group",{staticClass:"energy-list",attrs:{name:"el-zoom-in-center",tag:"div"}},e._l(e.energyList.filter((e=>e.show)),(function(a){return t("div",{key:a.id,staticClass:"energy-item mb-3"},[t("el-popconfirm",{attrs:{title:"确定删除该能源项吗"},on:{confirm:function(t){return e.removeEnergy(a)}}},[t("i",{staticClass:"pwc-funct-icons-close-outline close",attrs:{slot:"reference"},slot:"reference"})]),t("h5",[e._v(e._s(a.name))]),t("div",{staticClass:"energy-item__charts"},[t("div",[t("chart",{ref:"chart",refInFor:!0,staticStyle:{width:"100%","max-height":"100px"},attrs:{options:a.chartOne,autoresize:""}}),a.benchmark.grossCV?t("count-to",{staticClass:"chart-percent",attrs:{startVal:0,endVal:e.getChartPercentage(a.benchmark.grossCV,a.planning.grossCV),duration:1e3,decimals:0,suffix:"%"}}):t("span",{staticClass:"chart-percent"},[e._v("N/A")]),t("h5",{staticClass:"text-darker-grey"},[e._v("Gross CV "),t("small",[e._v("(TJ)")])]),t("p",[t("span",{staticClass:"text-grey"},[e._v(e._s(e.searchForm.benchmarkYear)+": "),t("count-to",{staticClass:"value",attrs:{startVal:0,endVal:a.benchmark.grossCV,duration:1e3,decimals:0}})],1),t("br"),e._v(" "+e._s(e.searchForm.planningYear)+": "),t("count-to",{staticClass:"value",attrs:{startVal:0,endVal:a.planning.grossCV,duration:1e3,decimals:0}})],1)],1),t("div",[t("chart",{ref:"chart",refInFor:!0,staticStyle:{width:"100%","max-height":"100px"},attrs:{options:a.chartTwo,autoresize:""}}),a.benchmark.co2e?t("count-to",{staticClass:"chart-percent",attrs:{startVal:0,endVal:e.getChartPercentage(a.benchmark.co2e,a.planning.co2e),duration:1e3,decimals:0,suffix:"%"}}):t("span",{staticClass:"chart-percent"},[e._v("N/A")]),t("h5",{staticClass:"text-darker-grey"},[e._v("CO2e "),t("small",[e._v("(Tonne)")])]),t("p",[t("span",{staticClass:"text-grey"},[e._v(e._s(e.searchForm.benchmarkYear)+": "),t("count-to",{staticClass:"value",attrs:{startVal:0,endVal:a.benchmark.co2e,duration:1e3,decimals:0}})],1),t("br"),e._v(" "+e._s(e.searchForm.planningYear)+": "),t("count-to",{staticClass:"value",attrs:{startVal:0,endVal:a.planning.co2e,duration:1e3,decimals:0}})],1)],1),t("div",[t("chart",{ref:"chart",refInFor:!0,staticStyle:{width:"100%","max-height":"100px"},attrs:{options:a.chartThree,autoresize:""}}),a.benchmark.cost?t("count-to",{staticClass:"chart-percent",attrs:{startVal:0,endVal:e.getChartPercentage(a.benchmark.cost,a.planning.cost),duration:1e3,decimals:0,suffix:"%"}}):t("span",{staticClass:"chart-percent"},[e._v("N/A")]),t("h5",{staticClass:"text-darker-grey"},[e._v(" Cost "),t("small",[e._v("(USD'000)")]),t("el-popover",{attrs:{title:"Set Price",placement:"bottom",width:"200",trigger:"click"}},[t("el-form",{attrs:{"label-position":"top"}},[t("el-form-item",{staticClass:"mb-2",attrs:{label:e.searchForm.benchmarkYear}},[t("el-input-number",{staticClass:"w-100",attrs:{precision:2,step:1},on:{change:function(t){return e.changeEnergyData(a)}},model:{value:a.benchmark.price,callback:function(t){e.$set(a.benchmark,"price",t)},expression:"item.benchmark.price"}})],1),t("el-form-item",{staticClass:"mb-2",attrs:{label:e.searchForm.planningYear}},[t("el-input-number",{staticClass:"w-100",attrs:{precision:2,step:1},on:{change:function(t){return e.changeEnergyData(a)}},model:{value:a.planning.price,callback:function(t){e.$set(a.planning,"price",t)},expression:"item.planning.price"}})],1)],1),t("i",{staticClass:"pwc-funct-icons-settings-outline",attrs:{slot:"reference"},slot:"reference"})],1)],1),t("p",[t("span",{staticClass:"text-grey"},[e._v(e._s(e.searchForm.benchmarkYear)+": "),t("count-to",{staticClass:"value",attrs:{startVal:0,endVal:a.benchmark.cost,duration:1e3,decimals:0}})],1),t("br"),e._v(" "+e._s(e.searchForm.planningYear)+": "),t("count-to",{staticClass:"value",attrs:{startVal:0,endVal:a.planning.cost,duration:1e3,decimals:0}})],1)],1)]),t("div",{staticClass:"energy-item__slider"},[t("div",{staticClass:"label"},[e._v(e._s(e.searchForm.benchmarkYear))]),t("div",{staticClass:"progress"},[t("el-slider",{attrs:{min:0,max:e.calcMaxValue(a.benchmark.value,a.planning.value),step:1,"show-tooltip":!1,disabled:""},model:{value:a.benchmark.value,callback:function(t){e.$set(a.benchmark,"value",t)},expression:"item.benchmark.value"}}),t("div",{staticClass:"value",style:{marginLeft:e.calcPercentage(a.benchmark.value,a.planning.value)+"%"}},[e._v(" "+e._s(e.numeral(a.benchmark.value).format("0,0"))+" ")])],1)]),t("div",{staticClass:"energy-item__slider"},[t("div",{staticClass:"label"},[e._v(e._s(e.searchForm.planningYear))]),t("div",{staticClass:"progress"},[t("el-slider",{attrs:{min:0,max:e.calcMaxValue(a.benchmark.value,a.planning.value),step:1,"format-tooltip":()=>e.formatTooltip(a)},on:{input:function(t){return e.changeEnergyData(a)}},model:{value:a.planning.value,callback:function(t){e.$set(a.planning,"value",t)},expression:"item.planning.value"}}),t("div",{staticClass:"value",style:{marginLeft:e.calcPercentage(a.planning.value,a.benchmark.value)+"%"}},[e._v(" "+e._s(e.numeral(a.planning.value).format("0,0"))+" ")])],1)])],1)})),0)],1)],1)},Ce=[],_e=a(15607),we=a(47221),xe=a.n(we),ke=a(2361),Le=a.n(ke);const Te={grossCV:.3,co2e:.5,cost:.1};var Se={name:"EnergyPortfolioSimulation",components:{chart:_e.Z,CountTo:xe()},data(){return{searchForm:{benchmarkYear:"",planningYear:"",organisation:""},totalList:[{name:"Gross CV",id:"grossCV",unit:"TJ",chartOption:{},benchmark:0,planning:0},{name:"CO2e",id:"co2e",unit:"Tonne",chartOption:{},benchmark:0,planning:0},{name:"Cost",id:"cost",unit:"USD'000",chartOption:{},benchmark:0,planning:0}],energyList:[{name:"Solar Electricity",id:"1",chartOne:{},chartTwo:{},chartThree:{},benchmark:{grossCV:0,co2e:0,cost:0,value:0,price:1},planning:{grossCV:0,co2e:0,cost:0,value:130,price:1},show:!0},{name:"Wind Electricity",id:"2",chartOne:{},chartTwo:{},chartThree:{},benchmark:{grossCV:0,co2e:0,cost:0,value:240,price:1},planning:{grossCV:0,co2e:0,cost:0,value:240,price:1},show:!0},{name:"Electricity",id:"3",chartOne:{},chartTwo:{},chartThree:{},benchmark:{grossCV:0,co2e:0,cost:0,value:120,price:1},planning:{grossCV:0,co2e:0,cost:0,value:150,price:1},show:!0},{name:"Petrol",id:"4",chartOne:{},chartTwo:{},chartThree:{},benchmark:{grossCV:0,co2e:0,cost:0,value:500,price:1},planning:{grossCV:0,co2e:0,cost:0,value:450,price:1},show:!0},{name:"Diesel",id:"5",chartOne:{},chartTwo:{},chartThree:{},benchmark:{grossCV:0,co2e:0,cost:0,value:90,price:1},planning:{grossCV:0,co2e:0,cost:0,value:70,price:1},show:!0},{name:"Waste Oils",id:"6",chartOne:{},chartTwo:{},chartThree:{},benchmark:{grossCV:0,co2e:0,cost:0,value:10,price:1},planning:{grossCV:0,co2e:0,cost:0,value:200,price:1},show:!0},{name:"Bioethanol",id:"7",chartOne:{},chartTwo:{},chartThree:{},benchmark:{grossCV:0,co2e:0,cost:0,value:100,price:1},planning:{grossCV:0,co2e:0,cost:0,value:100,price:1}},{name:"Bio Petrol",id:"8",chartOne:{},chartTwo:{},chartThree:{},benchmark:{grossCV:0,co2e:0,cost:0,value:500,price:1},planning:{grossCV:0,co2e:0,cost:0,value:250,price:1}},{name:"LPG",id:"9",chartOne:{},chartTwo:{},chartThree:{},benchmark:{grossCV:0,co2e:0,cost:0,value:1e3,price:1},planning:{grossCV:0,co2e:0,cost:0,value:0,price:1}}],selectEnergy:""}},computed:{treeSelectObj(){return{id:"id",label:"nameCode",children:"children",path:"path",content:"content",pid:"pid"}}},methods:{numeral:Le(),async init(){const e=(new Date).getFullYear();this.searchForm.benchmarkYear=String(e-1),this.searchForm.planningYear=String(e),this.energyList.forEach((e=>{this.initEnergyData(e)})),this.initTotalListData()},changeEnergyData(e){this.initEnergyData(e),this.initTotalListData()},initEnergyData(e){e.benchmark.grossCV=e.benchmark.value*Te.grossCV,e.benchmark.co2e=e.benchmark.value*Te.co2e,e.benchmark.cost=e.benchmark.value*e.benchmark.price,e.planning.grossCV=e.planning.value*Te.grossCV,e.planning.co2e=e.planning.value*Te.co2e,e.planning.cost=e.planning.value*e.planning.price;const t=this.getChartOption(0,e.benchmark.grossCV,e.planning.grossCV),a=this.getChartOption(1,e.benchmark.co2e,e.planning.co2e),i=this.getChartOption(2,e.benchmark.cost,e.planning.cost);this.$set(e,"chartOne",t),this.$set(e,"chartTwo",a),this.$set(e,"chartThree",i)},initTotalListData(){this.totalList.forEach(((e,t)=>{const a=this.getTotalSum("benchmark",e.id),i=this.getTotalSum("planning",e.id);this.$set(e,"benchmark",a),this.$set(e,"planning",i);const n=this.getChartOption(t,a,i);this.$set(e,"chartOption",n)}))},getTreeSelected(e){if(Array.isArray(e)){const t=this.$Utils.copyData(this.departmentId),a=this.$Utils.copyData(e);t.sort().toString()!==a.sort().toString()&&(this.departmentId=e)}else this.departmentId!==e&&(this.departmentId=e)},getTotalSum(e,t){let a=0;return this.energyList.forEach((i=>{i.show&&(a+=i[e][t])})),a},getChartOption(e,t,a){const i={color:["#eee","#eee","#7d7d7d","orange"],angleAxis:{max:100,splitLine:!1,axisLine:!1},radiusAxis:{type:"category",data:[" "],axisLine:!1},polar:{radius:["50%","80%"]},series:[{type:"bar",data:[100],coordinateSystem:"polar",stack:"benchmark"},{type:"bar",data:[100],coordinateSystem:"polar",stack:"planning"},{type:"bar",data:[0],coordinateSystem:"polar",name:"benchmark",stack:"benchmark",roundCap:!0},{type:"bar",data:[0],coordinateSystem:"polar",name:"planning",stack:"planning",roundCap:!0}]};return t&&a?t>a?(i.series[2].data[0]=100,i.series[3].data[0]=a/t*100):(i.series[3].data[0]=100,i.series[2].data[0]=t/a*100):t&&!a?(i.series[2].data[0]=100,i.series[3].data[0]=0):!t&&a?(i.series[2].data[0]=0,i.series[3].data[0]=100):(i.series[2].data[0]=0,i.series[3].data[0]=0),i},getChartPercentage(e,t){let a=0;return t?(e&&(a=t/e*100),a):a},calcMaxValue(e,t){const a=1.05;let i=105;return e>=t&&e>=100?i=e*a:t>e&&t>=100&&(i=t*a),i},calcPercentage(e,t){let a=0;if(e){const i=this.calcMaxValue(e,t);a=e/i*100}return a},formatTooltip(e){let t="0%";if(e.planning.value)if(e.benchmark.value){const a=e.planning.value/e.benchmark.value*100;t=100*a.toFixed(2)/100+"%"}else t="N/A";return t},addEnergy(){this.energyList.forEach((e=>{e.id===this.selectEnergy&&(this.$set(e,"show",!0),this.selectEnergy="")})),this.initTotalListData()},removeEnergy(e){e.show=!1,this.initTotalListData()}},created(){this.init()}},Fe=Se,De=(0,o.Z)(Fe,ye,Ce,!1,null,null,null),Pe=De.exports,Oe=function(){var e=this,t=e._self._c;return t("div",{staticClass:"calendar"},[t("el-card",{staticStyle:{"margin-bottom":"10px"},attrs:{shadow:"never","body-style":"padding: 10px;"}},[t("el-form",{attrs:{model:e.form,inline:"",size:"small","label-position":"right"}},[t("el-form-item",{staticClass:"ml-3 mb-0",attrs:{label:"月份",prop:"date"}},[t("el-date-picker",{staticStyle:{width:"110px"},attrs:{type:"month",format:"yyyy-M","value-format":"yyyy-M",clearable:!1},on:{change:function(t){return e.changeDate()}},model:{value:e.form.date,callback:function(t){e.$set(e.form,"date",t)},expression:"form.date"}})],1),t("el-form-item",{staticClass:"ml-3 mb-0",attrs:{label:"大组分享",prop:"largeGroupPreach"}},[t("el-select",{staticStyle:{width:"140px"},attrs:{multiple:"","collapse-tags":""},on:{change:function(t){return e.generate()}},model:{value:e.form.largeGroupPreach,callback:function(t){e.$set(e.form,"largeGroupPreach",t)},expression:"form.largeGroupPreach"}},e._l(e.largeGroupPreach,(function(e){return t("el-option",{key:e.value,attrs:{label:e.name,value:e.value}})})),1)],1),t("el-form-item",{staticClass:"ml-3 mb-0",attrs:{label:"小组讲员",prop:"smallGroupPreach"}},[t("el-select",{staticStyle:{width:"140px"},attrs:{multiple:"","collapse-tags":""},on:{change:function(t){return e.generate()}},model:{value:e.form.smallGroupPreach,callback:function(t){e.$set(e.form,"smallGroupPreach",t)},expression:"form.smallGroupPreach"}},e._l(e.smallGroupPreach,(function(e){return t("el-option",{key:e.value,attrs:{label:e.name,value:e.value}})})),1)],1),t("el-form-item",{staticClass:"ml-2 mb-0"},[t("el-button",{attrs:{type:"primary",icon:"el-icon-refresh"},on:{click:function(t){return e.generate(!0)}}},[e._v("随机派单")]),t("el-button",{attrs:{type:"default",icon:"el-icon-refresh-right"},on:{click:function(t){return e.generate()}}},[e._v("默认派单")]),t("el-tooltip",{attrs:{placement:"top"}},[t("div",{attrs:{slot:"content"},slot:"content"},[e._v(" 派单规则："),t("br"),e._v(" 1.共分成4个牧区，相同牧区的小组一起圣餐和总会学习；"),t("br"),e._v(" 2.每个小组每月一次圣餐和总会学习；"),t("br"),e._v(" 3.其它分享按讲员顺序或随机生成 ")]),t("el-button",{staticClass:"ml-3",attrs:{type:"text",icon:"el-icon-warning-outline"}},[e._v(" 派单说明 ")])],1)],1)],1)],1),t("el-table",{attrs:{data:e.tableData,size:"small",border:"",stripe:"","highlight-current-row":""}},e._l(e.columns,(function(a,i){return t("el-table-column",{key:i,attrs:{width:a.width,fixed:a.fixed,prop:a.prop,label:a.label},scopedSlots:e._u([{key:"default",fn:function({row:i}){return["name"===a.prop?[e._v(" "+e._s(i[a.prop])+" "),t("el-select",{staticStyle:{float:"right",width:"70px"},attrs:{size:"mini",placeholder:"请选择"},model:{value:i.area,callback:function(t){e.$set(i,"area",t)},expression:"row.area"}},e._l(e.areas,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)]:[e._l(e.largeGroupPreach,(function(n,l){return[n.value===i[a.prop]?t("el-tag",{key:l,attrs:{type:e.formatTagType(n.value),size:"small"}},[e._v(" "+e._s(n.name)+" ")]):e._e()]})),e._l(e.smallGroupPreach,(function(n,l){return[n.value===i[a.prop]?t("el-tag",{key:l,attrs:{type:"info",size:"small"}},[e._v(" "+e._s(n.name)+" ")]):e._e()]}))]]}}],null,!0)})})),1)],1)},Ie=[];const Ve=[{name:"朱梅",area:1},{name:"大琳",area:1},{name:"朱亚花",area:1},{name:"华星花",area:1},{name:"须建芬",area:2},{name:"姚花琴",area:2},{name:"王闵夏",area:2},{name:"赵小萍",area:2},{name:"赵萍",area:3},{name:"鲁玉月",area:3},{name:"李雪清",area:3},{name:"袁理珍",area:3},{name:"赵敬兵",area:3},{name:"王利民",area:4},{name:"刘彦馨",area:4},{name:"刘登江",area:4},{name:"赵其友",area:4},{name:"陈克君",area:4}],Ee=[{name:"圣餐",value:"ShengCan"},{name:"总会",value:"ZongHui"}],$e=[{name:"朱梅",value:"ZhuMei"},{name:"爱芳",value:"AiFang"},{name:"凌莹",value:"LingYing"},{name:"须建芬",value:"XuJianfen"},{name:"姚花琴",value:"YaoHuaqin"},{name:"王闵夏",value:"WangMinxia"},{name:"赵小萍",value:"ZhaoXiaoping"},{name:"赵萍",value:"ZhaoPing"},{name:"袁理珍",value:"YuanLizhen"},{name:"赵敬兵",value:"ZhaoJingbing"},{name:"朱玲",value:"ZhuLing"},{name:"刘彦馨",value:"LiuYanxin"},{name:"张晶",value:"ZhangJing"},{name:"赵其友",value:"ZhaoQiyou"},{name:"方志刚",value:"FangZhigang"},{name:"陈克君",value:"ChenKejun"},{name:"许玉红",value:"XuYuhong"}];var Ye={name:"SermonCalendar",data(){return{form:{date:"2022-7",largeGroupPreach:[],smallGroupPreach:[]},largeGroupPreach:[...Ee],smallGroupPreach:[...$e],areas:[{label:"1区",value:1},{label:"2区",value:2},{label:"3区",value:3},{label:"4区",value:4}],tableData:[]}},computed:{columns(){const e=[{label:"组名",prop:"name",width:150,fixed:!0}],t=this.form.date.split("-");let a=this.getWeekDay(t[0],t[1],0);return a.forEach((t=>{const a={label:t,prop:t};e.push(a)})),e}},methods:{getMonthLength(e){let t=new Date(e);return t.setMonth(t.getMonth()+1),t.setDate("1"),t.setDate(t.getDate()-1),t.getDate()},getWeekDay(e,t,a){e=Number(e);for(var i=[],n=this.getMonthLength(`${e}-${t}`),l=1;l<=n;l++)new Date(`${e}-${t}-${l}`).getDay()===a&&i.push(`${e}-${t}-${l}`);return i},changeDate(){this.resetData(),this.$nextTick((()=>{this.generate()}))},formatTagType(e){let t="info";return"ShengCan"===e?t="danger":"ZongHui"===e&&(t="success"),t},init(){this.resetData(),this.$nextTick((()=>{this.generate()}))},resetData(){this.form.largeGroupPreach=[],this.form.smallGroupPreach=[],this.largeGroupPreach.forEach((e=>{this.form.largeGroupPreach.push(e.value)})),this.smallGroupPreach.forEach((e=>{this.form.smallGroupPreach.push(e.value)})),this.tableData=[],Ve.forEach((e=>{const t={};this.columns.forEach((a=>{"name"===a.prop?t["name"]=e.name:t[a.prop]=""})),t["area"]=e.area,this.tableData.push(t)}))},generate(e){const t=this.form.date.split("-");let a=this.getWeekDay(t[0],t[1],0);this.tableData.forEach((e=>{a.forEach((t=>{e[t]=""}))}));let i=this.areas.map((e=>e.value));e&&i.sort((function(){return Math.random()-.5})),this.tableData.forEach((e=>{this.form.largeGroupPreach.forEach(((t,a)=>{const n=i[e.area-a]||i[0],l=this.columns[n]&&this.columns[n].prop;e[l]=t}))}));let n=[...this.form.smallGroupPreach];e&&n.sort((function(){return Math.random()-.5}));let l=0;a.forEach((e=>{this.tableData.forEach((t=>{t[e]||(l>=n.length&&(l=0),t[e]=n[l],l++)}))}))}},created(){const e=new Date,t=e.getUTCFullYear(),a=e.getMonth();this.form.date=`${t}-${a+1}`,this.init()}},je=Ye,Me=(0,o.Z)(je,Oe,Ie,!1,null,null,null),ze=Me.exports;i["default"].use(m.Z);const Ge=[{path:"/",name:"home",component:y},{path:"/projects",name:"projects",component:L},{path:"/join-tables",name:"joinTables",component:ge},{path:"/simulation",name:"simulation",component:Pe},{path:"/sermon-calendar",name:"sermonCalendar",component:ze}],Ze=new m.Z({routes:Ge});var Ne=Ze,Ae=a(1708),Je=a.n(Ae);i["default"].use(Je()),i["default"].config.productionTip=!1,new i["default"]({router:Ne,render:e=>e(u)}).$mount("#app")}},t={};function a(i){var n=t[i];if(void 0!==n)return n.exports;var l=t[i]={exports:{}};return e[i].call(l.exports,l,l.exports,a),l.exports}a.m=e,function(){var e=[];a.O=function(t,i,n,l){if(!i){var s=1/0;for(u=0;u<e.length;u++){i=e[u][0],n=e[u][1],l=e[u][2];for(var r=!0,o=0;o<i.length;o++)(!1&l||s>=l)&&Object.keys(a.O).every((function(e){return a.O[e](i[o])}))?i.splice(o--,1):(r=!1,l<s&&(s=l));if(r){e.splice(u--,1);var c=n();void 0!==c&&(t=c)}}return t}l=l||0;for(var u=e.length;u>0&&e[u-1][2]>l;u--)e[u]=e[u-1];e[u]=[i,n,l]}}(),function(){a.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return a.d(t,{a:t}),t}}(),function(){a.d=function(e,t){for(var i in t)a.o(t,i)&&!a.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})}}(),function(){a.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){a.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){var e={143:0};a.O.j=function(t){return 0===e[t]};var t=function(t,i){var n,l,s=i[0],r=i[1],o=i[2],c=0;if(s.some((function(t){return 0!==e[t]}))){for(n in r)a.o(r,n)&&(a.m[n]=r[n]);if(o)var u=o(a)}for(t&&t(i);c<s.length;c++)l=s[c],a.o(e,l)&&e[l]&&e[l][0](),e[l]=0;return a.O(u)},i=self["webpackChunkprojects"]=self["webpackChunkprojects"]||[];i.forEach(t.bind(null,0)),i.push=t.bind(null,i.push.bind(i))}();var i=a.O(void 0,[998],(function(){return a(37024)}));i=a.O(i)})();
//# sourceMappingURL=app.2a3d313a.js.map